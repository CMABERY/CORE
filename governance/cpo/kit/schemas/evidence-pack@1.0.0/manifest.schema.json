{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "evidence-pack@1.0.0/manifest.schema.json",
  "title": "Evidence Pack Manifest",
  "type": "object",
  "required": [
    "protocol_version",
    "pack_id",
    "agent",
    "window",
    "integrity",
    "exports"
  ],
  "properties": {
    "protocol_version": {
      "const": "evidence-pack@1.0.0"
    },
    "pack_id": {
      "type": "string"
    },
    "agent": {
      "type": "object",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "owner": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "window": {
      "type": "object",
      "required": [
        "start",
        "end"
      ],
      "properties": {
        "start": {
          "type": "string"
        },
        "end": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "diff_since": {
      "type": "object",
      "properties": {
        "baseline_pack_id": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "integrity": {
      "type": "object",
      "required": [
        "hash_chain_head"
      ],
      "properties": {
        "hash_chain_head": {
          "type": "string"
        },
        "algo": {
          "type": "string"
        }
      },
      "additionalProperties": true
    },
    "exports": {
      "type": "object",
      "required": [
        "pdf",
        "json"
      ],
      "properties": {
        "pdf": {
          "type": "string"
        },
        "json": {
          "type": "string"
        },
        "csv": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "files": {
      "type": "string"
    }
  },
  "additionalProperties": false
}